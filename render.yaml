services:
  - type: web
    name: magnus-api
    runtime: docker
    region: oregon  # Cambia según tu preferencia (oregon, frankfurt, singapore)
    plan: free  # Cambia a 'starter' o superior en producción
    branch: master
    dockerfilePath: ./Dockerfile
    envVars:
      - key: ASPNETCORE_ENVIRONMENT
        value: Production
      - key: ASPNETCORE_URLS
        value: http://+:8080
      - key: ConnectionStrings__DefaultConnection
        fromDatabase:
          name: magnus-postgres
          property: connectionString
      - key: Jwt__Key
        generateValue: true  # Genera automáticamente un secreto seguro
      - key: Jwt__Issuer
        value: MagnusApi
      - key: Jwt__Audience
        value: MagnusClient
    healthCheckPath: /health
    autoDeploy: true  # Despliegue automático desde GitHub

databases:
  - name: magnus-postgres
    databaseName: magnusdb
    plan: free  # Cambia a 'starter' o superior en producción
    region: oregon
    postgresMajorVersion: 16
